# 01-Translator

## Challenge
- chall.py
```python
import os
from Crypto.Cipher import AES
from Crypto.Util.Padding import pad
from Crypto.Util.number import bytes_to_long


def encrypt(plaintext, key):
    cipher = AES.new(key, AES.MODE_ECB)
    return cipher.encrypt(pad(plaintext.encode(), 16))

flag = os.environ.get("FLAG", "CTF{dummy_flag}")
flag_bin = f"{bytes_to_long(flag.encode()):b}"
trans_0 = input("translations for 0> ")
trans_1 = input("translations for 1> ")
flag_translated = flag_bin.translate(str.maketrans({"0": trans_0, "1": trans_1}))
key = os.urandom(16)
print("ct:", encrypt(flag_translated, key).hex())
```

## Solution

16バイトごとに暗号化されるので、<br>
下記のように 1 bit を 16 bytes にすれば平文の bit 列が得られます

0 -> A * 16<br>
1 -> B * 16

- solver.py
```python
from Crypto.Util.number import long_to_bytes

# 取得した値を入力
# 32bytes単位で入力（`ctf4b`で始まる）
# 最終的に0と1を切り替える2通りでも解ける
ct = ''
zero = ''
one = ''

# 実際に使った値
ct = '18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c818a58809a41e09de53cedf2c1b7ec3c8448cb328cd30e2b9ac43ab95d7d8460a18a58809a41e09de53cedf2c1b7ec3c8'
zero = '448cb328cd30e2b9ac43ab95d7d8460a'
one = '18a58809a41e09de53cedf2c1b7ec3c8'

block_size = 32
blocks = [ct[i:i+block_size] for i in range(0, len(ct), block_size)]

bitstring = ''
for block in blocks:
    if block == one:
        bitstring += '1'
    elif block == zero:
        bitstring += '0'

num = int(bitstring, 2)
print(long_to_bytes(num))
```