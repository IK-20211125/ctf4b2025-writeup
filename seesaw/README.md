# seesaw

## Challenge
- chall.py
```python
import os
from Crypto.Util.number import getPrime

FLAG = os.getenv("FLAG", "ctf4b{dummy_flag}").encode()
m = int.from_bytes(FLAG, 'big')

p = getPrime(512)   
q = getPrime(16)
n = p * q
e = 65537
c = pow(m, e, n)

print(f"{n = }")
print(f"{c = }")
```

- output.txt
```
n = 362433315617467211669633373003829486226172411166482563442958886158019905839570405964630640284863309204026062750823707471292828663974783556794504696138513859209
c = 104442881094680864129296583260490252400922571545171796349604339308085282733910615781378379107333719109188819881987696111496081779901973854697078360545565962079
```

## Solution

q が小さいため一般的な素因数分解が可能です。

- solver.py
```python
import sympy
from Crypto.Util.number import *

n = 362433315617467211669633373003829486226172411166482563442958886158019905839570405964630640284863309204026062750823707471292828663974783556794504696138513859209
e = 65537
c = 104442881094680864129296583260490252400922571545171796349604339308085282733910615781378379107333719109188819881987696111496081779901973854697078360545565962079

factors = sympy.factorint(n)
factors = list(factors.keys())
p = factors[0]
q = factors[1]
phi = (p-1) * (q-1)
d = pow(e,-1,phi)
decrypted_flag = pow(c,d,n)
print(long_to_bytes(decrypted_flag))
```